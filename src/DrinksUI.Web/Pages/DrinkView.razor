@page "/drink/{DrinkId:int}"

@using DrinksUI.Data.Types
@using DrinksUI.Dtos;
@using DrinksUI.Data.Services

@inject DrinkService DrinkService

<h3>@_drink.Name</h3>

@_drink.Description

<br>
<br>
<h5>Ingredients:</h5>

<EditForm Model=@_drink>


        @foreach (var addie in _drink.Addies.OrderBy(x => x.Ingredient.AddieType))
        {
            <div class="row"> 
                
                    @if (addie.IsLiquid)
                    {
                        <div class="col-sm-2">  
                            <InputNumber @bind-Value=addie.Amount class="form-control" id="@addie.Name"/>
                        </div>
                    }else
                    {
                        <div class="col-sm-5"> 
                            @addie.Display
                        </div>
                    }
                
                    @if (addie.IsLiquid)
                    {
                        <div class="col-sm-5"> 
                            <label for=@addie.Name>@addie.UnitAndName</label>
                        </div>
                    } 
            </div><br>
        }
    <input type="submit" class="btn btn-primary" value="Pour"/>
</EditForm>

@code {
    [Parameter]
    public int DrinkId { get; set; }
    private Drink _drink { get; set; }

    protected override async Task OnInitializedAsync()
    {
        _drink = await DrinkService.GetDrink(DrinkId);
    }

    void FormSubmitted(EditContext editContext)
    {
        bool formIsValid = editContext.Validate();
        Console.WriteLine(_drink.Name);
    }
}
